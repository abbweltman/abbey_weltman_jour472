---
title: "abbey_Data_notebook"
format: html
editor: visual
---

```{r}
library(tidyverse)
library(janitor)
library(sf)
library(leaflet)
```

Exploring Business Development in Baltimore

In this notebook I will look into the dynamics of business development in Baltimore, Maryland. By examining datasets related to the distribution of new businesses across different regions of Baltimore, we aim to uncover insights into the patterns and trends of entreprenurial activity within the city.

My analysis focuses on several key aspects:

1. Spatial Distribution of New Businesses: We investigate which regions of Baltimore have the highest concentration of new businesses, providing valuable insights into areas experiencing significant entrepreneurial activity.

2.Percentage of New Businesses Relative to Total: By comparing the percentage of new businesses to the total number of businesses in each region, we gain a deeper understanding of the prevalence of entrepreneurial ventures within the broader business landscape of Baltimore.

3.Analysis of Business Development: I will explore how business development has evolved over recent years by examining changes in the percentage of new businesses from previous years to the present, shedding light on the dynamics of economic growth and adaptation.

4. Mapping Business Development Trends to represent the spatial distribution of new businesses and highlight regions experiencing notable shifts in entrepreneurial activity.

```{r}
#First I am going to load my datasets 
new_business <- read_csv("~/Documents/GitHub/abbey_weltman_jour472/data_analysis/Percent_of_Businesses_that_are_4_Years_old_or_less.csv")
total_businesses <- read_csv("~/Documents/GitHub/abbey_weltman_jour472/data_analysis/Total_Number_of_Businesses.csv")
one_yr_biz <- read_csv("~/Documents/GitHub/abbey_weltman_jour472/data_analysis/Percent_of_Businesses_that_are_1_Year_old_or_less (1).csv")
Census_Tract_2020 <- read_csv("~/Documents/GitHub/abbey_weltman_jour472/data_analysis/Census_Tract_(2020)_to_Community_Statistical_Area_(2020).csv")

```
```{r}
#the first dataset I want to look at is which regions in Baltimore have the most buisness under 4 years old. I am going to use the average of two most recent years. 

new_business_high <- new_business  %>%
 select(CSA2020,biz4_20, biz4_21) %>%
 arrange(desc(biz4_21))%>%
mutate(biz_av= round((biz4_20 + biz4_21)/2,2)) 
 #sort(desc("biz_av"))

#The region of Baltimore with highest percent of new businesses from 2021 was Oldtown/Middle East. 

new_business_low <- new_business  %>%
 select(CSA2020,biz4_20, biz4_21) %>%
  arrange(biz4_21)%>%
  mutate(biz_av= round((biz4_20 + biz4_21)/2,2)) 

#The region of Baltimore with lowest percent of new businesses from 2021 was Westport/Mount Winans/Lakeland 

```


```{r}
#Now I was to plot these findings on a map. first I am going to make a dataset. That we can apply to the map with the parameters of the regions. 

#bmore_shapefile <- st_read("assets/data/Community_Statistical_Area_(2020).shp")
leaflet() %>%
  addProviderTiles(providers$CartoDB.Positron) %>%
  addPolygons(data=new_business_high, weight=1, fill="purple") %>%
  addCircles(data=biz4_21,
             label=biz4_21)

```

```{r}
#The next question I wanted to solve was what percentage of total businesses in a region of Baltimore are under 4 Years old. To determine this I will combine the total business table with the businessmen under 4 years old table to compare the percents of many business in the area are relatively new. 

pct_total_new_biz <- total_businesses %>%
inner_join(new_business, by="CSA2020")%>%
select(CSA2020, numbus21, biz4_21)%>%
mutate(pct_whole = round(biz4_21 / numbus21) * 100,2)%>%
arrange(desc(pct_whole))

#Edmondson Village had the highest percent of 4 or less year old businesses out of the regions total amount of businesses. The percent of new businesses out of the total is about 55.5% 

```

```{r}
#the next question I wanted to determine was how did new business development grow from 2019-2021. I will determine this by comparing the values of new business under 4 years old for the past three years and then determine the percent change. then I can filter to see which 10 regions had the highest change in percentage points. 

biz_dev <- Percent_of_Businesses_that_are_4_Years_old_or_less %>%
select(CSA2020, biz4_19, biz4_21) %>%
mutate(pct_change = round((biz4_21 - biz4_19) / biz4_19 * 100,2))%>%
arrange(desc(pct_change))

#The region of Baltimore with the largest percentage change from 2019-2021 in business development is Dickeyville/Franklintown with a percent change of 112%. 

```

```{r}
#the question I want to look at the distribution of business development in Baltimore on a map visual. To do this I am going to select the top 10 regions of Baltimore that had the highest percent of business under 4 years old and plot them on a map. 

one_yr_constant <- one_yr_biz %>%
  inner_join(new_business, by = "CSA2020") %>%
#select(CSA2020, biz1_21, biz4_21.y) %>%
arrange(desc(biz1_21))

#the region of Baltimore with the highest percent of business 1 year old or less is  Oldtown/Middle East this is consistent with what I saw in the the 4 years or less data. So there are consistently experiencing rapid business development over the past 4 years so now I want to see the percent change of just Oldtown/Middle East in the past couple years. 

oldtown_pctchange <- one_yr_biz %>%
inner_join(new_business, by = "CSA2020") %>%
  select(CSA2020, biz1_19, biz1_21) %>%
  filter(CSA2020 == "Oldtown/Middle East") %>%
mutate(pct_change = ((biz1_21 - biz1_19) / biz1_19 * 100))

# The Percent change from 2019-2021 in Oldtown/ Middle East Region of Baltimore was -56%. This likely due to the pandemic. 

```

